<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MENTECH Robot KontrolÃ¼</title>
    <style>
        /* Ana sayfa ve arka plan stilleri */
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            background: linear-gradient(to bottom right, #1a202c, #2d3748); /* Koyu gradyan arka plan */
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh; /* Tam ekran yÃ¼ksekliÄŸi */
            padding: 1rem;
            color: #fff; /* Beyaz metin rengi */
            /* position: relative; Removed from body, now container is relative */
        }
        /* Ana iÃ§erik kapsayÄ±cÄ±sÄ± */
        .container {
            background-color: #2d3748; /* Koyu gri arka plan */
            padding: 2rem;
            border-radius: 0.75rem; /* Yuvarlak kÃ¶ÅŸeler */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5), 0 8px 10px -6px rgba(0, 0, 0, 0.5); /* GÃ¶lge efekti */
            width: 100%;
            max-width: 28rem; /* Maksimum geniÅŸlik */
            border: 1px solid #4a5568; /* KenarlÄ±k */
            position: relative; /* Farlar butonu iÃ§in referans noktasÄ± */
        }
        /* BaÅŸlÄ±k stili */
        h1 {
            font-size: 1.875rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 2rem;
            color: #fff;
        }
        /* Alt baÅŸlÄ±k stili (Kamera KontrolÃ¼ iÃ§in) */
        h3 {
            font-size: 1rem;
            font-weight: bold;
            text-align: center;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }
        /* Kontrol dÃ¼ÄŸmeleri Ä±zgara dÃ¼zeni */
        .control-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 3 eÅŸit sÃ¼tun */
            gap: 1rem; /* BoÅŸluk */
            margin-bottom: 2rem;
            justify-items: center;
            align-items: center;
        }
        /* TÃ¼m dÃ¼ÄŸmeler iÃ§in genel stil */
        .button {
            background-color: #4299e1; /* Mavi arka plan */
            color: white;
            font-weight: bold;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem; /* Yuvarlak kÃ¶ÅŸeler */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -2px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease-in-out; /* YumuÅŸak geÃ§iÅŸler */
            transform: scale(1);
            cursor: pointer;
            border: none;
            outline: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            width: 100%;
            height: 100%;
            min-height: 60px;
            -webkit-user-select: none; /* Metin seÃ§ilmesini engelle */
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent; /* Mobil cihazlarda dokunma vurgusunu kaldÄ±r */
        }
        /* DÃ¼ÄŸme Ã¼zerine gelindiÄŸinde */
        .button:hover {
            background-color: #3182ce;
            transform: scale(1.05);
        }
        /* DÃ¼ÄŸmeye basÄ±ldÄ±ÄŸÄ±nda */
        .button:active {
            transform: scale(0.98);
        }
        /* DÃ¼ÄŸme odaklandÄ±ÄŸÄ±nda */
        .button:focus {
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5), 0 0 0 6px rgba(66, 153, 225, 0.25);
        }
        /* Devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸ dÃ¼ÄŸmeler */
        .button[disabled] {
            opacity: 0.5;
            cursor: not-allowed;
        }
        /* DÃ¼ÄŸme iÃ§indeki SVG ikonlarÄ± */
        .button svg {
            height: 1.5rem;
            width: 1.5rem;
            stroke: currentColor;
            stroke-width: 2;
        }
        /* KÄ±rmÄ±zÄ± dÃ¼ÄŸme stili */
        .button.red {
            background-color: #e53e3e;
        }
        .button.red:hover {
            background-color: #c53030;
        }
        /* Mor dÃ¼ÄŸme stili */
        .button.purple {
            background-color: #805ad5;
        }
        .button.purple:hover {
            background-color: #6b46c1;
        }
        /* SarÄ± dÃ¼ÄŸme stili */
        .button.yellow {
            background-color: #d69e2e;
        }
        .button.yellow:hover {
            background-color: #b7791f;
        }
        /* Izgara Ã¶ÄŸelerinin pozisyonlarÄ± */
        .grid-item-top { grid-column: 2 / 3; grid-row: 1 / 2; }
        .grid-item-left { grid-column: 1 / 2; grid-row: 2 / 3; }
        .grid-item-center { grid-column: 2 / 3; grid-row: 2 / 3; }
        .grid-item-right { grid-column: 3 / 4; grid-row: 2 / 3; }
        .grid-item-bottom { grid-column: 2 / 3; grid-row: 3 / 4; }

        /* GiriÅŸ alanlarÄ± iÃ§in genel stil */
        .input-area {
            margin-bottom: 2rem;
            padding: 1rem;
            background-color: #4a5568; /* Koyu gri arka plan */
            border-radius: 0.5rem;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        /* GiriÅŸ alanÄ± baÅŸlÄ±klarÄ± */
        .input-area h2 {
            font-size: 1.25rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 1rem;
        }
        /* GiriÅŸ alanÄ± iÃ§indeki dÃ¼ÄŸmeler */
        .input-area .button {
            width: auto; /* GeniÅŸliÄŸi iÃ§eriÄŸe gÃ¶re ayarla */
            min-height: 40px; /* Minimum yÃ¼ksekliÄŸi azalt */
            padding: 0.5rem 1.5rem; /* Dolguyu azalt */
            font-size: 0.875rem; /* YazÄ± boyutunu kÃ¼Ã§Ã¼lt */
            display: inline-flex; /* Ä°Ã§eriÄŸe gÃ¶re geniÅŸlemesini saÄŸla ve ortalanabilir yap */
            margin-top: 0.5rem; /* Ãœst boÅŸluÄŸu koru */
        }
        .input-area .button svg {
            height: 1.25rem; /* Ä°kon boyutunu kÃ¼Ã§Ã¼lt */
            width: 1.25rem;
            margin-bottom: 0.125rem; /* Ä°kon alt boÅŸluÄŸunu azalt */
        }

        /* KaydÄ±rÄ±cÄ± (Slider) kapsayÄ±cÄ±sÄ± */
        .slider-container {
            margin-top: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem;
            background-color: #2d3748;
            border-radius: 0.5rem;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.3);
        }
        /* KaydÄ±rÄ±cÄ± input stili */
        .slider-container input[type="range"] {
            -webkit-appearance: none; /* VarsayÄ±lan gÃ¶rÃ¼nÃ¼mÃ¼ kaldÄ±r */
            width: 100%;
            height: 8px;
            background: #4a5568; /* KaydÄ±rÄ±cÄ± yolu rengi */
            outline: none;
            border-radius: 4px;
            cursor: pointer;
        }
        /* KaydÄ±rÄ±cÄ± baÅŸparmak (thumb) stili (Webkit - Chrome/Safari) */
        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%; /* Yuvarlak baÅŸparmak */
            background: #4299e1; /* Mavi baÅŸparmak rengi */
            cursor: pointer;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5); /* Mavi dÄ±ÅŸ halka */
        }
        /* KaydÄ±rÄ±cÄ± baÅŸparmak (thumb) stili (Mozilla - Firefox) */
        .slider-container input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4299e1;
            cursor: pointer;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5);
        }
        /* KaydÄ±rÄ±cÄ± deÄŸer gÃ¶stergesi */
        .slider-container .speed-value {
            font-weight: bold;
            color: #fff;
            min-width: 40px;
            text-align: right;
        }

        /* Farlar butonu iÃ§in yeni konumlandÄ±rma (container'a gÃ¶re) */
        .headlights-floating-button {
            position: absolute; /* KapsayÄ±cÄ±ya gÃ¶re konumlandÄ±r */
            top: 1rem; /* KapsayÄ±cÄ±nÄ±n Ã¼stÃ¼nden 1rem boÅŸluk */
            right: 1rem; /* KapsayÄ±cÄ±nÄ±n saÄŸÄ±ndan 1rem boÅŸluk */
            width: 48px; /* Daha kÃ¼Ã§Ã¼k boyut */
            height: 48px; /* Daha kÃ¼Ã§Ã¼k boyut */
            padding: 0.5rem; /* Ä°Ã§ boÅŸluÄŸu azalt */
            border-radius: 50%; /* Tamamen yuvarlak */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -2px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10; /* DiÄŸer elementlerin Ã¼zerinde gÃ¶rÃ¼nmesini saÄŸla */
        }
        .headlights-floating-button svg {
            height: 1.5rem; /* Ä°kon boyutu */
            width: 1.5rem; /* Ä°kon boyutu */
            margin-bottom: 0; /* Metin olmadÄ±ÄŸÄ± iÃ§in boÅŸluk yok */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>MENTECH</h1>

        <button class="button yellow headlights-floating-button" onclick="toggleHeadlights()" id="headlightsBtn">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="M20 12h2"/><path d="M2 12h2"/><path d="m18.364 5.636-.707.707"/><path d="m6.343 17.657-.707.707"/><path d="m5.636 5.636.707.707"/><path d="m17.657 17.657.707.707"/>
            </svg>
        </button>

        <div class="control-grid">
            <button class="button grid-item-top"
                    onmousedown="startContinuousMove(event, 'Ä°leri')" ontouchstart="startContinuousMove(event, 'Ä°leri')"
                    onmouseup="stopContinuousMove(event)" ontouchend="stopContinuousMove(event)" onmouseleave="stopContinuousMove(event)"
                    id="forwardBtn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 19V5M5 12l7-7 7 7" />
                </svg>
            </button>

            <button class="button purple grid-item-left"
                    onmousedown="startContinuousMove(event, 'Sola DÃ¶n')" ontouchstart="startContinuousMove(event, 'Sola DÃ¶n')"
                    onmouseup="stopContinuousMove(event)" ontouchend="stopContinuousMove(event)" onmouseleave="stopContinuousMove(event)"
                    id="leftBtn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M11 17l-5-5 5-5M19 12H6" />
                </svg>
            </button>

            <button class="button red grid-item-center" onclick="sendMovementCommand('Durduruldu')" id="stopBtn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <rect x="7" y="7" width="10" height="10" rx="2" ry="2" />
                </svg>
            </button>

            <button class="button purple grid-item-right"
                    onmousedown="startContinuousMove(event, 'SaÄŸa DÃ¶n')" ontouchstart="startContinuousMove(event, 'SaÄŸa DÃ¶n')"
                    onmouseup="stopContinuousMove(event)" ontouchend="stopContinuousMove(event)" onmouseleave="stopContinuousMove(event)"
                    id="rightBtn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 17l5-5-5-5M6 12h12" />
                </svg>
            </button>

            <button class="button grid-item-bottom"
                    onmousedown="startContinuousMove(event, 'Geri')" ontouchstart="startContinuousMove(event, 'Geri')"
                    onmouseup="stopContinuousMove(event)" ontouchend="stopContinuousMove(event)" onmouseleave="stopContinuousMove(event)"
                    id="backwardBtn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 5v14M19 12l-7 7-7-7" />
                </svg>
            </button>
        </div>

        <div class="input-area">
            <h2>âš™ï¸ Motor GÃ¼cÃ¼</h2>
            <div class="slider-container">
                <input type="range" id="motorSpeedSlider" min="30" max="100" value="30" oninput="updateMotorSpeed(this.value)">
                <span id="motorSpeedValue" class="speed-value">30%</span>
            </div>
        </div>

        <div class="input-area">
            <h2>ğŸ“· Kamera KontrolÃ¼ (Pan/Tilt)</h2>
            <h3>SaÄŸ / Sol (Pan)</h3>
            <div class="slider-container">
                <input type="range" id="panSlider" min="0" max="180" value="90" oninput="updatePanAngle(this.value)">
                <span id="panAngleValue" class="speed-value">90Â°</span>
            </div>
            <h3>YukarÄ± / AÅŸaÄŸÄ± (Tilt)</h3>
            <div class="slider-container">
                <input type="range" id="tiltSlider" min="0" max="180" value="90" oninput="updateTiltAngle(this.value)">
                <span id="tiltAngleValue" class="speed-value">90Â°</span>
            </div>
        </div>

    </div>

    <script>
        // Blynk kimlik doÄŸrulama belirteci (Auth Token)
        const BLYNK_AUTH_TOKEN = "N0zjD19SQgkbPqSTPM40PJjA9JqQAJck"; 

        // Blynk sanal pin tanÄ±mlamalarÄ±
        const VIRTUAL_PIN_MOVEMENT = 'V0';
        const VIRTUAL_PIN_HEADLIGHTS = 'V1';
        const VIRTUAL_PIN_MOTOR_SPEED = 'V2'; 
        const VIRTUAL_PIN_PAN_SERVO = 'V3';   // Pan Servo iÃ§in sanal pin
        const VIRTUAL_PIN_TILT_SERVO = 'V4';  // Tilt Servo iÃ§in sanal pin

        // HTML elementlerini JavaScript deÄŸiÅŸkenlerine atama
        const motorSpeedSlider = document.getElementById('motorSpeedSlider');
        const motorSpeedValueDisplay = document.getElementById('motorSpeedValue');
        const headlightsBtn = document.getElementById('headlightsBtn'); // Farlar butonu

        const panSlider = document.getElementById('panSlider');
        const panAngleValueDisplay = document.getElementById('panAngleValue');
        const tiltSlider = document.getElementById('tiltSlider');
        const tiltAngleValueDisplay = document.getElementById('tiltAngleValue');

        // Durum deÄŸiÅŸkenleri
        let headlightsOn = false; 
        let movementInterval; 
        let currentActiveDirection = ''; // Hangi yÃ¶nÃ¼n aktif olduÄŸunu tutar

        // Durum mesajlarÄ±nÄ± konsola yazdÄ±rma fonksiyonu
        function setStatus(status, message = '') {
            console.log(`Durum: ${status}, Mesaj: ${message}`);
        }

        // ButonlarÄ± ve slider'larÄ± devre dÄ±ÅŸÄ± bÄ±rakma/etkinleÅŸtirme
        function setButtonsDisabled(disabled) {
            // TÃ¼m kontrol dÃ¼ÄŸmelerini ve slider'larÄ± devre dÄ±ÅŸÄ± bÄ±rak/etkinleÅŸtir
            document.querySelectorAll('.button, input[type="range"]').forEach(element => {
                // Farlar butonu ayrÄ± ele alÄ±nacaÄŸÄ±ndan, burada hareket ve hÄ±z butonlarÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakalÄ±m.
                // headlightsBtn.disabled = disabled; // Bu satÄ±rÄ± kaldÄ±rdÄ±k, Ã§Ã¼nkÃ¼ artÄ±k ayrÄ± bir yerde
                if (element.id !== 'headlightsBtn') { // Farlar butonunu hariÃ§ tut
                    element.disabled = disabled;
                }
            });
        }

        // Robot hareket komutlarÄ±nÄ± Blynk'e gÃ¶nderme
        async function sendMovementCommand(direction) {
            setStatus(direction, `Robot komutu gÃ¶nderiliyor: ${direction}`);
            
            try {
                // Blynk HTTP API'sine GET isteÄŸi gÃ¶nderme
                const response = await fetch(
                    `https://blynk.cloud/external/api/update?token=${BLYNK_AUTH_TOKEN}&${VIRTUAL_PIN_MOVEMENT}=${direction}`,
                    { method: 'GET' }
                );

                if (response.ok) {
                    setStatus(direction, `Komut baÅŸarÄ±yla gÃ¶nderildi: ${direction}`);
                } else {
                    const errorText = await response.text();
                    setStatus(direction, `Komut gÃ¶nderilemedi: ${response.status} - ${errorText}`);
                }
            } catch (error) {
                setStatus('Hata!', `AÄŸ hatasÄ±: ${error.message}. Blynk sunucusuna ulaÅŸÄ±lamÄ±yor olabilir.`);
            }
        }

        // FarlarÄ± aÃ§ma/kapatma komutunu Blynk'e gÃ¶nderme
        async function toggleHeadlights() {
            // Farlar butonunu sadece bu fonksiyonun baÅŸÄ±nda devre dÄ±ÅŸÄ± bÄ±rakÄ±p sonunda etkinleÅŸtireceÄŸiz.
            headlightsBtn.disabled = true; 
            const newState = !headlightsOn; // FarlarÄ±n yeni durumu
            setStatus('Farlar', `Farlar ${newState ? 'aÃ§Ä±lÄ±yor' : 'kapanÄ±yor'}...`);

            try {
                // Blynk HTTP API'sine GET isteÄŸi gÃ¶nderme (1: aÃ§Ä±k, 0: kapalÄ±)
                const response = await fetch(
                    `https://blynk.cloud/external/api/update?token=${BLYNK_AUTH_TOKEN}&${VIRTUAL_PIN_HEADLIGHTS}=${newState ? 1 : 0}`,
                    { method: 'GET' }
                );

                if (response.ok) {
                    headlightsOn = newState; // Durumu gÃ¼ncelle
                    setStatus('Farlar', `Farlar baÅŸarÄ±yla ${newState ? 'aÃ§Ä±ldÄ±' : 'kapandÄ±'}.`);
                } else {
                    const errorText = await response.text();
                    setStatus('Farlar', `Farlar komutu gÃ¶nderilemedi: ${response.status} - ${errorText}`);
                }
            } catch (error) {
                setStatus('Hata!', `AÄŸ hatasÄ±: ${error.message}. Blynk sunucusuna ulaÅŸÄ±lamÄ±yor olabilir.`);
            } finally {
                headlightsBtn.disabled = false; // Ä°ÅŸlem bitince farlar butonunu etkinleÅŸtir
            }
        }

        // Motor hÄ±z komutunu Blynk'e gÃ¶nderme
        async function sendMotorSpeed(speedPercentage) {
            setStatus('HÄ±z AyarÄ±', `Motor gÃ¼cÃ¼ ayarlanÄ±yor: ${speedPercentage}%`);
            try {
                const response = await fetch(
                    `https://blynk.cloud/external/api/update?token=${BLYNK_AUTH_TOKEN}&${VIRTUAL_PIN_MOTOR_SPEED}=${speedPercentage}`,
                    { method: 'GET' }
                );
                if (response.ok) {
                    setStatus('HÄ±z AyarÄ±', `Motor gÃ¼cÃ¼ baÅŸarÄ±yla ayarlandÄ±: ${speedPercentage}%`);
                } else {
                    const errorText = await response.text();
                    setStatus('HÄ±z AyarÄ±', `Motor gÃ¼cÃ¼ gÃ¶nderilemedi: ${response.status} - ${errorText}`);
                }
            } catch (error) {
                setStatus('Hata!', `AÄŸ hatasÄ±: ${error.message}. Blynk sunucusuna ulaÅŸÄ±lamÄ±yor olabilir.`);
            }
        }

        // Motor hÄ±zÄ± slider'Ä± deÄŸiÅŸtiÄŸinde Ã§aÄŸrÄ±lÄ±r
        function updateMotorSpeed(value) {
            motorSpeedValueDisplay.textContent = `${value}%`;
            sendMotorSpeed(value);
        }

        // Servo aÃ§Ä± komutlarÄ±nÄ± Blynk'e gÃ¶nderme
        async function sendServoAngle(pin, angle, type) {
            console.log(`${type} Servo aÃ§Ä±sÄ± ayarlanÄ±yor: ${angle}Â°`);
            try {
                const response = await fetch(
                    `https://blynk.cloud/external/api/update?token=${BLYNK_AUTH_TOKEN}&${pin}=${angle}`,
                    { method: 'GET' }
                );
                if (response.ok) {
                    console.log(`${type} Servo aÃ§Ä±sÄ± baÅŸarÄ±yla ayarlandÄ±: ${angle}Â°`);
                } else {
                    const errorText = await response.text();
                    console.error(`${type} Servo aÃ§Ä±sÄ± gÃ¶nderilemedi: ${response.status} - ${errorText}`);
                }
            } catch (error) {
                console.error('Hata!', `AÄŸ hatasÄ±: ${error.message}. Blynk sunucusuna ulaÅŸÄ±lamÄ±yor olabilir.`);
            }
        }

        // Pan slider'Ä± deÄŸiÅŸtiÄŸinde Ã§aÄŸrÄ±lÄ±r
        function updatePanAngle(value) {
            panAngleValueDisplay.textContent = `${value}Â°`;
            sendServoAngle(VIRTUAL_PIN_PAN_SERVO, value, 'Pan');
        }

        // Tilt slider'Ä± deÄŸiÅŸtiÄŸinde Ã§aÄŸrÄ±lÄ±r
        function updateTiltAngle(value) {
            tiltAngleValueDisplay.textContent = `${value}Â°`;
            sendServoAngle(VIRTUAL_PIN_TILT_SERVO, value, 'Tilt');
        }

        // SÃ¼rekli hareket komutunu baÅŸlatma (basÄ±lÄ± tutma)
        function startContinuousMove(event, direction) {
            event.preventDefault(); // VarsayÄ±lan davranÄ±ÅŸÄ± (metin seÃ§imi gibi) engelle
            console.log(`startContinuousMove tetiklendi: ${direction}`);

            if (currentActiveDirection === direction) {
                console.log(`Zaten ${direction} yÃ¶nÃ¼nde hareket ediliyor.`);
                return;
            }
            
            if (movementInterval) {
                clearInterval(movementInterval); // Ã–nceki interval'i temizle
                movementInterval = null;
                console.log("Ã–nceki hareket interval'i temizlendi.");
            }

            currentActiveDirection = direction; // Aktif yÃ¶nÃ¼ ayarla
            sendMovementCommand(direction); // Ä°lk komutu hemen gÃ¶nder

            // Her 200ms'de bir komutu tekrar gÃ¶nder
            movementInterval = setInterval(() => {
                sendMovementCommand(direction);
            }, 200); 
        }

        // SÃ¼rekli hareket komutunu durdurma (bÄ±rakma)
        function stopContinuousMove(event) {
            event.preventDefault(); // VarsayÄ±lan davranÄ±ÅŸÄ± engelle
            console.log("stopContinuousMove tetiklendi.");

            if (movementInterval) {
                clearInterval(movementInterval); // SÃ¼rekli gÃ¶ndermeyi durdur
                movementInterval = null; // Interval ID'sini sÄ±fÄ±rla
                console.log("Hareket interval'i durduruldu.");
            }
            
            // Sadece eÄŸer robot aktif bir yÃ¶nde hareket ediyorsa Durduruldu komutunu gÃ¶nder
            if (currentActiveDirection !== '') {
                sendMovementCommand('Durduruldu'); // Durdurma komutunu gÃ¶nder
                currentActiveDirection = ''; // Aktif yÃ¶nÃ¼ sÄ±fÄ±rla
                console.log("Durduruldu komutu gÃ¶nderildi.");
            }
        }

        // Sayfa yÃ¼klendiÄŸinde baÅŸlangÄ±Ã§ ayarlarÄ±
        window.onload = () => {
            motorSpeedSlider.value = 30;
            updateMotorSpeed(motorSpeedSlider.value);
            
            panSlider.value = 90; // BaÅŸlangÄ±Ã§ta 90 derece
            updatePanAngle(panSlider.value);
            tiltSlider.value = 90; // BaÅŸlangÄ±Ã§ta 90 derece
            updateTiltAngle(tiltSlider.value);
        };
    </script>
</body>
</html>
